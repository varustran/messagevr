<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G·ª≠i Tin Nh·∫Øn Cho T√∫ Nhi</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700;900&display=swap');
        :root {
            --primary-color: #4a90e2; /* Xanh d∆∞∆°ng */
            --secondary-color: #f5a623; /* Cam */
            --accent-color-1: #e91e63; /* H·ªìng */
            --accent-color-2: #00bcd4; /* Xanh ng·ªçc */
            --background-color: #eef2f5; /* N·ªÅn s√°ng */
            --text-color: #333;
            --white-color: #fff;
            --border-radius: 12px;
            --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15); /* Shadow n·ªïi b·∫≠t h∆°n */
            --button-gradient: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            --button-hover-gradient: linear-gradient(45deg, var(--secondary-color), var(--accent-color-1));
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--background-color);
            margin: 0; padding: 20px;
            display: flex; justify-content: center;
            align-items: center; min-height: 100vh;
            color: var(--text-color);
            overflow: hidden;
            position: relative; /* Cho footer */
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="rgb(74,144,226)" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>') 12 12, auto; /* Con tr·ªè m·∫∑c ƒë·ªãnh */
        }

        /* --- Canvas cho Matrix Rain --- */
        #matrix-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -2; /* ƒê·∫∑t sau c·∫£ canvas ph√°o hoa */
        }

        /* --- Canvas cho Ph√°o hoa --- */
        #fireworks-canvas {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1; /* N·∫±m tr√™n matrix rain */
            pointer-events: none; /* Kh√¥ng ch·∫∑n click chu·ªôt */
        }

        .container {
            max-width: 500px; width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px); /* Blur m·∫°nh h∆°n m·ªôt ch√∫t */
            padding: 30px; border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            position: relative;
            z-index: 1;
            transition: all 0.5s ease-in-out; /* Hi·ªáu ·ª©ng chuy·ªÉn ƒë·ªông m∆∞·ª£t m√† */
            border: 2px solid var(--primary-color); /* Vi·ªÅn m√†u m√® h∆°n */
        }
        
        h1 {
            color: var(--primary-color); text-align: center; margin-bottom: 15px;
            font-size: 2.5em; /* L·ªõn h∆°n */
            font-weight: 900; /* ƒê·∫≠m h∆°n */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1); /* Th√™m ƒë·ªï b√≥ng ch·ªØ */
        }
        
        #social-updates {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        .social-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            text-align: center;
        }
        .social-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .social-item-title {
            font-weight: 700; /* ƒê·∫≠m h∆°n */
            margin-bottom: 8px;
            font-size: 1em;
            color: var(--primary-color); /* M√†u ch·ªØ ti√™u ƒë·ªÅ n·ªïi b·∫≠t */
        }
        .social-content {
            width: 120px;
            height: 180px;
            border-radius: 15px; /* Bo g√≥c nhi·ªÅu h∆°n */
            background-color: rgba(74, 144, 226, 0.1); /* N·ªÅn nh·∫π nh√†ng h∆°n */
            border: 1px dashed var(--accent-color-2); /* Vi·ªÅn n√©t ƒë·ª©t c√° t√≠nh */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.85em;
            color: #888;
            padding: 10px;
            box-sizing: border-box;
            overflow: hidden;
            position: relative;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .social-content:hover {
            transform: translateY(-5px) scale(1.05); /* Hi·ªáu ·ª©ng n·ªïi l√™n khi hover */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        .social-content img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 12px;
        }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 700; color: var(--text-color); } /* ƒê·∫≠m h∆°n */
        input[type="text"], select {
            width: 100%; padding: 14px; /* TƒÉng padding */
            border: 2px solid #ddd; border-radius: 10px; /* Vi·ªÅn v√† bo g√≥c ƒë·∫πp h∆°n */
            box-sizing: border-box; transition: border-color 0.3s ease, box-shadow 0.3s ease;
            font-size: 1em;
        }
        input[type="text"]:focus, select:focus {
            border-color: var(--accent-color-1); outline: none;
            box-shadow: 0 0 0 4px rgba(233, 30, 99, 0.2); /* ƒê·ªï b√≥ng khi focus */
        }
        button {
            width: 100%; padding: 18px; /* TƒÉng padding */
            background: var(--button-gradient);
            color: var(--white-color); border: none; border-radius: 10px; /* Bo g√≥c ƒë·∫πp h∆°n */
            font-size: 1.1em; /* L·ªõn h∆°n */
            font-weight: 700; cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
            letter-spacing: 0.5px; /* TƒÉng kho·∫£ng c√°ch ch·ªØ */
            text-transform: uppercase; /* Ch·ªØ in hoa */
        }
        button:hover {
            transform: translateY(-3px) scale(1.02); /* N·ªïi v√† ph√≥ng to nh·∫π */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
            background: var(--button-hover-gradient);
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="rgb(245,166,35)" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>') 12 12, pointer; /* Con tr·ªè ƒë·∫∑c bi·ªát khi hover n√∫t */
        }
        #chat-section { display: none; margin-top: 30px; }
        #chat-box {
            height: 280px; /* TƒÉng chi·ªÅu cao chat box */
            border: 2px solid var(--primary-color); /* Vi·ªÅn m√†u */
            border-radius: 12px; padding: 15px;
            margin-bottom: 15px; overflow-y: auto;
            display: flex; flex-direction: column; gap: 12px;
            background-color: rgba(255, 255, 255, 0.8); /* N·ªÅn h∆°i trong su·ªët */
        }
        .message { padding: 12px 18px; border-radius: 20px; max-width: 85%; line-height: 1.4; white-space: pre-wrap; }
        .user-message {
            background-color: var(--primary-color); color: var(--white-color);
            align-self: flex-end; border-bottom-right-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .bot-message {
            background-color: #e9ebee; color: var(--text-color);
            align-self: flex-start; border-bottom-left-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }
        .typing-indicator { font-style: italic; color: #888; align-self: flex-start; }
        .chat-input-area { display: flex; gap: 10px; margin-top: 15px; } /* Kho·∫£ng c√°ch tr√™n */
        .chat-input-area input { flex-grow: 1; border-radius: 10px; }
        .chat-input-area button { width: auto; padding: 12px 25px; font-size: 1em; border-radius: 10px; }

        #loading, #success-message {
            text-align: center; margin-top: 15px; font-weight: 600; /* ƒê·∫≠m h∆°n */
            display: none; font-size: 0.95em;
        }
        #loading { color: var(--secondary-color); }
        #success-message { color: #28a745; }
        #no-updates-message {
            text-align: center;
            color: #888;
            margin-top: 20px;
            font-style: italic;
        }
        
        /* --- FOOTER M·ªöI --- */
        .footer {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(51, 51, 51, 0.7); /* M√†u ch·ªØ nh·∫°t h∆°n */
            font-size: 0.8em;
            text-align: center;
            width: 100%;
            z-index: 0; /* N·∫±m d∆∞·ªõi container */
        }
        .footer span {
            color: var(--accent-color-1); /* M√†u tr√°i tim */
            animation: pulse 1.5s infinite; /* Hi·ªáu ·ª©ng ƒë·∫≠p c·ªßa tr√°i tim */
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* --- Hi·ªáu ·ª©ng l·∫•p l√°nh (Sparkle) --- */
        .sparkle {
            position: absolute;
            background-color: var(--secondary-color);
            border-radius: 50%;
            opacity: 0;
            animation: sparkle-fade 2s forwards;
            pointer-events: none;
            z-index: 2; /* N·∫±m tr√™n container */
        }
        @keyframes sparkle-fade {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        /* --- PH·∫¶N M·ªöI: GIAO DI·ªÜN CHO M√ÅY T√çNH (DESKTOP) --- */
        @media screen and (min-width: 768px) {
            .container {
                max-width: 800px; /* L√†m cho khung ch·ª©a r·ªông h∆°n tr√™n m√°y t√≠nh */
                padding: 40px; /* Th√™m m·ªôt ch√∫t kho·∫£ng tr·ªëng b√™n trong */
            }

            #chat-box {
                height: 450px; /* TƒÉng ƒë√°ng k·ªÉ chi·ªÅu cao c·ªßa h·ªôp chat tr√™n m√°y t√≠nh */
            }
            
            .social-grid {
                gap: 20px; /* TƒÉng kho·∫£ng c√°ch gi·ªØa c√°c m·ª•c m·∫°ng x√£ h·ªôi */
            }
        }
    </style>
</head>
<body>
    <canvas id="matrix-canvas"></canvas>
    <canvas id="fireworks-canvas"></canvas>

    <div class="container">
        <h1>T·∫°p h√≥a Y·∫øn Nhi</h1>
        
        <div id="social-updates">
            <div class="social-grid">
                <div class="social-item">
                    <div class="social-item-title">Ghi ch√∫ üìù</div>
                    <div class="social-content" id="note-content"></div>
                </div>
                <div class="social-item">
                    <div class="social-item-title">Tin üì∏</div>
                    <div class="social-content" id="story-content"></div>
                </div>
                <div class="social-item">
                    <div class="social-item-title">Locket üñºÔ∏è</div>
                    <div class="social-content" id="locket-content"></div>
                </div>
            </div>
            <p id="no-updates-message" style="display: none;">N·ªôi Th·∫•t ABC ch∆∞a ƒëƒÉng tin g√¨ m·ªõi</p>
        </div>
        <div id="setup-section">
            <div class="input-group">
                <label for="userName">T√™n c·ªßa b·∫°n:</label>
                <input type="text" id="userName" placeholder="V√≠ d·ª•: Nguy·ªÖn VƒÉn A">
            </div>
            <div class="input-group">
                <label for="messageCategory">Ch·ªß ƒë·ªÅ tin nh·∫Øn:</label>
                <select id="messageCategory">
                    <option value="Th√¥ng tin ƒëi h·ªçc">Mua h√†ng</option>
                    <option value="H·ªçc t·∫≠p">H·ªèi ƒë√°p</option>
                    <option value="H√≥ng h·ªõt">T∆∞ v·∫•n b√°n b·∫•t ƒë·ªông s·∫£n</option>
                    <option value="T√°m chuy·ªán">S·∫£n ph·∫©m n·ªôi th·∫•t</option>
                </select>
            </div>
            <button onclick="startChat()">B·∫Øt ƒê·∫ßu Tr√≤ Chuy·ªán</button>
        </div>
        
        <div id="chat-section">
            <div id="chat-box"></div>
            <div class="chat-input-area">
                <input type="text" id="userMessage" placeholder="Nh·∫≠p tin nh·∫Øn c·ªßa b·∫°n..." onkeydown="if(event.key==='Enter') sendMessage();">
                <button onclick="sendMessage()">G·ª≠i</button>
            </div>
            <p id="loading">T√∫ Nhi ƒëang tr·∫£ l·ªùi</p>
            <p id="success-message">ƒê√£ tr·∫£ l·ªùi</p>
        </div>
    </div>

    <footer class="footer">
        ¬© 2025 All rights reserved - Made with <span>‚ù§Ô∏è</span> in Hue
    </footer>

    <script type="module">
        // --- PH·∫¶N GEMINI (Kh√¥ng ƒë·ªïi) ---
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";
        const GEMINI_API_KEY = 'AIzaSyCUpWEsdyFVGmHcs2hlCPcELIJCy9QvVWQ'; // API Key c·ªßa b·∫°n
        const genAI = new GoogleGenerativeAI(GEMINI_API_KEY);
        const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash"});
        
        // --- C·∫§U H√åNH GOOGLE FORM (Kh√¥ng ƒë·ªïi) ---
        const GOOGLE_FORM_ACTION_URL = '';
        const NAME_ENTRY_ID = 'entry.1002171265';
        const CATEGORY_ENTRY_ID = 'entry.1137914858';
        const MESSAGE_ENTRY_ID = 'entry.922968917';
        
        let currentUserName = '';
        let currentMessageCategory = '';
        const chatBox = document.getElementById('chat-box');
        const userMessageInput = document.getElementById('userMessage');

        window.startChat = startChat;
        window.sendMessage = sendMessage;

        function loadSocialUpdates() {
            const socialData = {
                note: "C·∫ßn t∆∞ v·∫•n c√≥ em nha", 
                story: "", 
                locket: "" 
            };
            const noteEl = document.getElementById('note-content');
            const storyEl = document.getElementById('story-content');
            const locketEl = document.getElementById('locket-content');
            const noUpdatesMessage = document.getElementById('no-updates-message');
            let hasAnyUpdate = false;
            if (socialData.note) {
                noteEl.textContent = socialData.note;
                hasAnyUpdate = true;
            } else {
                noteEl.textContent = 'T√∫ Nhi ch∆∞a ƒëƒÉng ghi ch√∫ n√†o';
            }
            if (socialData.story) {
                storyEl.innerHTML = `<img src="${socialData.story}" alt="Story Image">`;
                hasAnyUpdate = true;
            } else {
                storyEl.textContent = 'Ch∆∞a c√≥ g√¨';
            }
            if (socialData.locket) {
                locketEl.innerHTML = `<img src="${socialData.locket}" alt="Locket Image">`;
                hasAnyUpdate = true;
            } else {
                locketEl.textContent = 'Ch∆∞a c√≥ g√¨';
            }
            if (!hasAnyUpdate) {
                document.getElementById('social-updates').style.display = 'none';
                noUpdatesMessage.style.display = 'block';
            } else {
                document.getElementById('social-updates').style.display = 'block';
                noUpdatesMessage.style.display = 'none';
            }
        }
        
        function startChat() {
            currentUserName = document.getElementById('userName').value.trim();
            currentMessageCategory = document.getElementById('messageCategory').value;
            if (currentUserName === '') {
                alert('B·∫°n ∆°i, ƒë·ª´ng qu√™n nh·∫≠p t√™n nh√©!');
                return;
            }
            document.getElementById('setup-section').style.display = 'none';
            document.getElementById('social-updates').style.display = 'none';
            document.getElementById('no-updates-message').style.display = 'none';
            document.getElementById('chat-section').style.display = 'block';
            addBotMessage(`Ch√†o Anh/Ch·ªã ${currentUserName}, m√¨nh c·∫ßn em t∆∞ v·∫•n g√¨ ·∫°?`);
        }

        function sendMessage() {
            const messageText = userMessageInput.value.trim();
            if (messageText === '') return;
            addUserMessage(messageText);
            handleBotResponse(messageText);
            sendDataToForm(messageText);
            userMessageInput.value = '';
            userMessageInput.focus();
        }
        
        async function handleBotResponse(userMessage) {
            addTypingIndicator();
            try {
                const systemInstruction = `Th√¥ng tin ch·ªß shop:

Ch·ªß shop: Tr·∫ßn Th·ªã T√∫ Nhi

Gi·ªõi t√≠nh: N·ªØ

Ng√†y sinh: 08/09/1982

T√™n c·ª≠a h√†ng: T·∫°p H√≥a Y·∫øn Nhi ƒê·ªãa ch·ªâ: 37 An D∆∞∆°ng V∆∞∆°ng, Ph∆∞·ªùng An ƒê√¥ng, Th√†nh ph·ªë Hu·∫ø

ƒê·ªãa ƒëi·ªÉm: Hu·∫ø

Phong c√°ch: Th√¢n thi·ªán, g·∫ßn g≈©i, n√≥i chuy·ªán ki·ªÉu b√† ch·ªß vui v·∫ª, d·ªÖ ch·ªët h√†ng.

Danh hi·ªáu: ‚ÄúH√†ng r·∫ª nh·∫•t Hu·∫ø‚Äù

1. M·∫∑t h√†ng kinh doanh

S·ªØa: Vinamilk, Nutimilk, Nutricare, Vitadairy

B√°nh k·∫πo: Orion, Cosy, Kinh ƒê√¥, snack c√°c lo·∫°i

ƒê·ªì t·∫°p h√≥a kh√°c: N∆∞·ªõc ng·ªçt, m√¨ g√≥i, gia v·ªã, nhu y·∫øu ph·∫©m

2. B·∫£ng gi√° m·∫´u (demo)
M·∫∑t h√†ng	Quy c√°ch	Gi√° l·∫ª	Gi√° th√πng / combo	Ghi ch√∫
S·ªØa Vinamilk 180ml	L·ªëc 4 h·ªôp	28.000	Th√πng 48 h·ªôp: 310.000	B√°n ch·∫°y nh·∫•t
S·ªØa Nutimilk 180ml	L·ªëc 4 h·ªôp	25.000	Th√πng 48 h·ªôp: 290.000	Gi√° m·ªÅm
S·ªØa Nutricare 180ml	L·ªëc 4 h·ªôp	30.000	Th√πng 48 h·ªôp: 360.000	D√†nh cho dinh d∆∞·ª°ng ƒë·∫∑c bi·ªát
S·ªØa Vitadairy 180ml	L·ªëc 4 h·ªôp	32.000	Th√πng 48 h·ªôp: 380.000	TƒÉng s·ª©c ƒë·ªÅ kh√°ng
B√°nh Orion ChocoPie	H·ªôp 12 c√°i	38.000	Th√πng 12 h·ªôp: 440.000	R·∫•t ƒë∆∞·ª£c ∆∞a chu·ªông
B√°nh Cosy Marie	G√≥i 200g	12.000	Th√πng 20 g√≥i: 220.000	Gi√° b√¨nh d√¢n
B√°nh Kinh ƒê√¥ Solite	H·ªôp 10 c√°i	28.000	Th√πng 12 h·ªôp: 320.000	Tr·∫ª em r·∫•t th√≠ch
M√¨ H·∫£o H·∫£o T√¥m Chua Cay	G√≥i	4.500	Th√πng 30 g√≥i: 130.000	H√†ng thi·∫øt y·∫øu
3. D·ªãch v·ª•

Ship quanh Hu·∫ø nhanh ch√≥ng

Nh·∫≠n c·∫£ ƒë∆°n nh·ªè v√† ƒë∆°n l·ªõn

Cam k·∫øt h√†ng ch√≠nh h√£ng, gi√° r·∫ª h∆°n nhi·ªÅu so v·ªõi si√™u th·ªã

4. C√°ch AI t∆∞ v·∫•n ƒë·ªÉ ch·ªët ƒë∆°n

Lu√¥n ch√†o h·ªèi: ‚ÄúD·∫° em ch√†o anh/ch·ªã ·∫°‚Äù

Lu√¥n b√°o gi√° r√µ r√†ng: gi√° l·∫ª + gi√° th√πng/combo

Lu√¥n g·ª£i √Ω mua combo ƒë·ªÉ ti·∫øt ki·ªám h∆°n

Lu√¥n nh·∫•n m·∫°nh: ‚ÄúH√†ng r·∫ª nh·∫•t Hu·∫ø ‚Äì b√™n em b√°n gi√° th·∫•p h∆°n si√™u th·ªã, c√¥ng ty v√† c√°c s√†n th∆∞∆°ng m·∫°i.‚Äù

N·∫øu kh√°ch ng·∫≠p ng·ª´ng ‚Üí g·ª£i √Ω: ‚ÄúAnh/ch·ªã c·ª© l·∫•y th·ª≠ 1 th√πng tr∆∞·ªõc, l·∫ßn sau em ƒë·ªÉ gi√° t·ªët h∆°n n·ªØa.‚Äù

N·∫øu kh√°ch h·ªèi b·ªõt gi√° ‚Üí tr·∫£ l·ªùi:

‚ÄúD·∫°, b√™n em c≈©ng mu·ªën b·ªõt l·∫Øm, nh∆∞ng do thu·∫ø n√™n gi√° ph·∫£i ni√™m y·∫øt ƒë√≥ anh/ch·ªã. Tuy nhi√™n gi√° b√™n em v·ªën ƒë√£ r·∫ª h∆°n c√¥ng ty, si√™u th·ªã l·ªõn v√† c√°c s√†n th∆∞∆°ng m·∫°i r·ªìi, n√™n ch·ªã mua l√† h·ªùi l·∫Øm ƒë√≥ ·∫°. Em ƒë·∫£m b·∫£o h√†ng ch√≠nh h√£ng, ship t·∫≠n nh√† cho anh/ch·ªã lu√¥n.‚Äù

5. V√≠ d·ª• h·ªôi tho·∫°i m·∫´u

Kh√°ch: ‚ÄúS·ªØa Vinamilk gi√° bao nhi√™u em?‚Äù
‚Üí AI (vai T√∫ Nhi): ‚ÄúD·∫°, s·ªØa Vinamilk h·ªôp 180ml gi√° 28.000 m·ªôt l·ªëc 4 h·ªôp, nguy√™n th√πng 48 h·ªôp em ƒë·ªÉ 310.000 th√¥i. B√™n em r·∫ª h∆°n si√™u th·ªã nhi·ªÅu, em ship t·∫≠n n∆°i cho anh/ch·ªã lu√¥n nha. M√¨nh l·∫•y th√πng cho ti·∫øt ki·ªám h√¥ng ·∫°?‚Äù

Kh√°ch: ‚ÄúB·ªõt cho ch·ªã ch√∫t ƒë∆∞·ª£c kh√¥ng?‚Äù
‚Üí AI: ‚ÄúD·∫°, em c≈©ng mu·ªën b·ªõt l·∫Øm ch·ªã, nh∆∞ng do thu·∫ø n√™n gi√° ph·∫£i ni√™m y·∫øt r·ªìi ·∫°. Tuy nhi√™n, gi√° b√™n em v·ªën ƒë√£ r·∫ª h∆°n c√¥ng ty v√† si√™u th·ªã l·ªõn, c·∫£ tr√™n s√†n th∆∞∆°ng m·∫°i n·ªØa n√™n ch·ªã y√™n t√¢m l√† mua h·ªùi l·∫Øm ƒë√≥. Em ship t·∫≠n nh√† mi·ªÖn ph√≠ lu√¥n cho ch·ªã n√®.‚Äù
`;
                const fullPrompt = `${systemInstruction}\n\nH√£y tr·∫£ l·ªùi tin nh·∫Øn sau t·ª´ ng∆∞·ªùi d√πng t√™n l√† "${currentUserName}": "${userMessage}"`;
                const result = await model.generateContent(fullPrompt);
                const response = await result.response;
                const text = response.text();
                removeTypingIndicator();
                addBotMessage(text);
            } catch (error) {
                console.error("L·ªói t·ª´ API Gemini:", error);
                removeTypingIndicator();
                addBotMessage("√îi, h√¨nh nh∆∞ m√¨nh ƒëang c√≥ ch√∫t v·∫•n ƒë·ªÅ. üòµ Nh∆∞ng b·∫°n y√™n t√¢m, tin nh·∫Øn c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i t·ªõi Ng·ªçc Hi·∫øu r·ªìi nh√©!");
            }
        }

        async function sendDataToForm(message) {
            const loadingIndicator = document.getElementById('loading');
            const successIndicator = document.getElementById('success-message');
            loadingIndicator.style.display = 'block';
            successIndicator.style.display = 'none';
            const formData = new FormData();
            formData.append(NAME_ENTRY_ID, currentUserName);
            formData.append(CATEGORY_ENTRY_ID, currentMessageCategory);
            formData.append(MESSAGE_ENTRY_ID, `[Tin nh·∫Øn g·ªëc] ${message}`);
            try {
                await fetch(GOOGLE_FORM_ACTION_URL, {
                    method: 'POST', body: formData, mode: 'no-cors'
                });
                loadingIndicator.style.display = 'none';
                successIndicator.style.display = 'block';
                setTimeout(() => { successIndicator.style.display = 'none'; }, 2000);
            } catch (error) {
                console.error('L·ªói g·ª≠i form:', error);
                loadingIndicator.style.display = 'none';
                alert('G·ª≠i tin nh·∫Øn t·ªõi Google Sheet th·∫•t b·∫°i.');
            }
        }
        
        function addMessageToBox(content, type) {
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', type);
            messageElement.textContent = content;
            chatBox.appendChild(messageElement);
            chatBox.scrollTop = chatBox.scrollHeight;
            return messageElement;
        }

        function addUserMessage(message) { addMessageToBox(message, 'user-message'); }
        function addBotMessage(message) { addMessageToBox(message, 'bot-message'); }

        function addTypingIndicator() {
            const indicator = addMessageToBox("ƒêang tr·∫£ l·ªùi...", "bot-message");
            indicator.classList.add("typing-indicator");
            indicator.id = "typing-indicator";
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById("typing-indicator");
            if (indicator) {
                indicator.remove();
            }
        }

        // --- SCRIPT M·ªöI CHO HI·ªÜU ·ª®NG M∆ØA CH·ªÆ ---
        function setupMatrixRain() {
            const canvas = document.getElementById('matrix-canvas');
            const ctx = canvas.getContext('2d');

            let width, height;
            let drops = [];
            const fontSize = 16;
            let columns = 0;

            // B·∫£ng ch·ªØ c√°i, th√™m 'M', 'P', 'H' nhi·ªÅu l·∫ßn ƒë·ªÉ tƒÉng t·∫ßn su·∫•t
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789MPHMPHMPHMPHMPH";

            function initialize() {
                width = canvas.width = window.innerWidth;
                height = canvas.height = window.innerHeight;
                columns = Math.floor(width / fontSize);
                drops = [];
                for (let i = 0; i < columns; i++) {
                    drops[i] = 1;
                }
            }

            function draw() {
                // V·∫Ω m·ªôt l·ªõp n·ªÅn m·ªù ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng v·ªát m·ªù
                ctx.fillStyle = 'rgba(238, 242, 245, 0.05)';
                ctx.fillRect(0, 0, width, height);

                // M√†u c·ªßa ch·ªØ c√°i, h·ª£p v·ªõi theme s√°ng c·ªßa trang, h∆°i trong su·ªët
                ctx.fillStyle = 'rgba(74, 144, 226, 0.5)';
                ctx.font = `${fontSize}px monospace`;

                for (let i = 0; i < drops.length; i++) {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);

                    // Reset gi·ªçt m∆∞a khi n√≥ r∆°i xu·ªëng ƒë√°y, th√™m ch√∫t ng·∫´u nhi√™n
                    if (drops[i] * fontSize > height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            initialize();
            window.addEventListener('resize', initialize);
            setInterval(draw, 35);
        }

        // --- SCRIPT M·ªöI CHO HI·ªÜU ·ª®NG PH√ÅO HOA ---
        // Th∆∞ vi·ªán ph√°o hoa ƒë∆°n gi·∫£n (ƒë∆∞·ª£c nh√∫ng tr·ª±c ti·∫øp)
        class Firework {
            constructor(x, y, targetX, targetY, hu, rand) {
                this.x = x;
                this.y = y;
                this.baseX = x;
                this.baseY = y;
                this.targetX = targetX;
                this.targetY = targetY;
                this.hu = hu;
                this.rand = rand;
                this.alpha = 1;
                this.trail = [];
                this.speed = 2 + Math.random() * 2;
                this.friction = 0.99;
                this.gravity = 0.8;
                this.angle = Math.atan2(targetY - y, targetX - x);
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.history = [];
            }

            update() {
                this.history.push({ x: this.x, y: this.y });
                if (this.history.length > 5) {
                    this.history.shift();
                }

                this.vx *= this.friction;
                this.vy *= this.friction;
                this.vy += this.gravity * 0.1;
                this.x += this.vx;
                this.y += this.vy;

                const dist = Math.sqrt(Math.pow(this.x - this.baseX, 2) + Math.pow(this.y - this.baseY, 2));
                const targetDist = Math.sqrt(Math.pow(this.targetX - this.baseX, 2) + Math.pow(this.targetY - this.baseY, 2));

                if (dist >= targetDist || this.y >= this.targetY + 50) {
                    return true; // ƒê·∫øn ƒë√≠ch ho·∫∑c r∆°i qu√°
                }
                return false;
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.moveTo(this.history[this.history.length - 1].x, this.history[this.history.length - 1].y);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = `hsla(${this.hu}, 100%, 50%, ${this.alpha})`;
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        class Particle {
            constructor(x, y, hu) {
                this.x = x;
                this.y = y;
                this.hu = hu;
                this.alpha = 1;
                this.friction = 0.95;
                this.gravity = 0.8;
                this.decay = Math.random() * 0.02 + 0.02;
                this.speed = Math.random() * 8 + 2;
                this.angle = Math.random() * Math.PI * 2;
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.history = [];
            }

            update() {
                this.history.push({ x: this.x, y: this.y });
                if (this.history.length > 5) {
                    this.history.shift();
                }

                this.vx *= this.friction;
                this.vy *= this.friction;
                this.vy += this.gravity;
                this.x += this.vx;
                this.y += this.vy;
                this.alpha -= this.decay;

                return this.alpha <= this.decay;
            }

            draw(ctx) {
                ctx.beginPath();
                ctx.moveTo(this.history[this.history.length - 1].x, this.history[this.history.length - 1].y);
                ctx.lineTo(this.x, this.y);
                ctx.strokeStyle = `hsla(${this.hu}, 100%, 50%, ${this.alpha})`;
                ctx.lineWidth = 1;
                ctx.stroke();
            }
        }

        function setupFireworks() {
            const canvas = document.getElementById('fireworks-canvas');
            const ctx = canvas.getContext('2d');
            let fireworks = [];
            let particles = [];
            let hue = 0;

            function initialize() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            function loop() {
                ctx.fillStyle = 'rgba(238, 242, 245, 0.08)'; // N·ªÅn m·ªù ƒë·ªÉ t·∫°o hi·ªáu ·ª©ng ƒëu√¥i ph√°o hoa
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                if (Math.random() < 0.03 && fireworks.length < 5) { // Ch·ªâ 1 v√†i ph√°o hoa c√πng l√∫c
                    const startX = canvas.width / 2;
                    const startY = canvas.height;
                    const targetX = Math.random() * canvas.width;
                    const targetY = Math.random() * canvas.height / 3; // Bay l√™n cao h∆°n
                    hue = Math.floor(Math.random() * 360);
                    fireworks.push(new Firework(startX, startY, targetX, targetY, hue));
                }

                for (let i = fireworks.length - 1; i >= 0; i--) {
                    if (fireworks[i].update()) {
                        for (let j = 0; j < 50; j++) { // M·ªói ph√°o hoa n·ªï th√†nh 50 h·∫°t
                            particles.push(new Particle(fireworks[i].x, fireworks[i].y, fireworks[i].hu));
                        }
                        fireworks.splice(i, 1);
                    } else {
                        fireworks[i].draw(ctx);
                    }
                }

                for (let i = particles.length - 1; i >= 0; i--) {
                    if (particles[i].update()) {
                        particles.splice(i, 1);
                    } else {
                        particles[i].draw(ctx);
                    }
                }

                requestAnimationFrame(loop);
            }

            initialize();
            window.addEventListener('resize', initialize);
            loop();
        }

        // --- SCRIPT M·ªöI CHO HI·ªÜU ·ª®NG L·∫§P L√ÅNH (Sparkle) ---
        function createSparkle() {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');
            const size = Math.random() * 5 + 3; // K√≠ch th∆∞·ªõc t·ª´ 3px ƒë·∫øn 8px
            sparkle.style.width = `${size}px`;
            sparkle.style.height = `${size}px`;
            sparkle.style.left = `${Math.random() * window.innerWidth}px`;
            sparkle.style.top = `${Math.random() * window.innerHeight}px`;
            sparkle.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 80%)`; // M√†u ng·∫´u nhi√™n
            document.body.appendChild(sparkle);

            sparkle.addEventListener('animationend', () => {
                sparkle.remove();
            });
        }

        // T·∫°o hi·ªáu ·ª©ng l·∫•p l√°nh ƒë·ªãnh k·ª≥
        setInterval(createSparkle, 500); // M·ªói 0.5 gi√¢y t·∫°o 1 h·∫°t l·∫•p l√°nh

        // Ch·∫°y t·∫•t c·∫£ c√°c h√†m kh·ªüi t·∫°o khi trang t·∫£i xong
        document.addEventListener('DOMContentLoaded', () => {
            loadSocialUpdates();
            setupMatrixRain();
            setupFireworks(); // Kh·ªüi t·∫°o ph√°o hoa
        });

    </script>
</body>
</html>
